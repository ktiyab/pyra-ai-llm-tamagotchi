<div align="center">

# ðŸ¦– Pyra

**An AI-Driven Virtual Pet Simulator with Persistent Memory, Evolving Personality & AI-Generated Portraits**

**Built with Google AI Studio (Gemini 3 Pro, Claude Opus 3.5) & Nano Banana**

[![Pyra](https://storage.googleapis.com/vai-pet/Gemini_Generated_Image_mpxpvfmpxpvfmpxp.jpg)](https://react.dev/)

*Your choices don't just keep Pyra aliveâ€”they shape who Pyra becomes.*

[Play Now](#-getting-started) â€¢ [Features](#-key-features) â€¢ [Architecture](#-architecture) â€¢ [Deep Dive](#-the-core-philosophy)

</div>

---

## ðŸŒŸ Overview

Pyra transcends traditional virtual pet mechanics by combining a React/Three.js frontend with Google's Gemini API as a **living brain** that drives a persistent "Nature vs. Nurture" simulation. Every interaction creates ripples through a psychological systemâ€”comfort a scared hatchling and watch them grow confident; neglect their needs and witness lasting anxiety take root.

**What makes Pyra different:**
- ðŸ§  **AI-powered personality** â€” Not scripted responses, but genuine reasoning about emotions (Gemini 2.5 Flash)
- ðŸ“¸ **AI-generated portraits** â€” Each Pyra gets unique artwork via Nano Banana (Gemini 2.5 Flash Image)
- ðŸ’¾ **Permanent memories** â€” Trauma and joy leave lasting marks
- ðŸŽ­ **Your parenting matters** â€” Early care shapes personality exponentially more than later care

This isn't a game you win. It's a relationship you build.

---

## âœ¨ Key Features

### ðŸ§  AI-Powered Personality Engine
- **Structured AI Responses** â€” Gemini returns dialogue, animation triggers, stat changes, and obedience decisions
- **Context-Aware Interactions** â€” Full life history, needs, and personality injected into every AI call
- **Dynamic Obedience** â€” Commands succeed or fail based on trust, respect, stage, and personality
- **Vocabulary Learning** â€” Pyra learns words you teach, stage-gated by development

### ðŸŽ¨ AI-Generated Portraits (Nano Banana)
- **Unique Artwork** â€” Each Pyra gets a one-of-a-kind portrait generated by Gemini 2.5 Flash Image
- **Color Accurate** â€” Portrait reflects your Pyra's actual body color, eye glow, and scale pattern
- **Personality Expression** â€” Facial expression matches dominant traits (shy, energetic, confident)
- **Stage-Appropriate** â€” Background and pose change based on growth stage
- **Smart Caching** â€” Portraits cached locally for 7 days to minimize API calls

### ðŸ“¸ Shareable PyraCard
- **Identity Snapshot** â€” Beautiful card showing name, stage, stats, traits, and care grade
- **AI Portrait Integration** â€” Your unique Pyra portrait displayed prominently
- **Featured Memory** â€” Most impactful memory quote displayed
- **One-Tap Sharing** â€” Web Share API with clipboard fallback
- **Kid-Friendly Design** â€” Large text, vibrant colors, easy to read

### ðŸŽ Daily Surprises System
- **Personality-Weighted Selection** â€” Surprises match your Pyra's traits (energetic Pyras chase butterflies)
- **Stage-Gated Content** â€” Older Pyras have more complex surprises
- **Cooldown Protection** â€” Maximum one surprise per ~20 hours
- **Variety** â€” Found items, learned tricks, funny moments, dreams, discoveries

### ðŸŽ‰ Celebration System
- **Evolution Fanfares** â€” Triumphant audio + enhanced confetti for stage transitions
- **Milestone Chimes** â€” Distinct sounds for trust milestones and streaks
- **Discovery Sounds** â€” Curious trills for daily surprises
- **Visual Spectacle** â€” Particle systems, glowing backgrounds, animated emoji

### ðŸ§¬ Nature vs. Nurture System
- **Innate Seed Traits** â€” Each Pyra hatches with randomized base personality dimensions
- **Permanent Personality Shifts** â€” Parenting style shifts traits along 6 spectrums
- **Stage Plasticity** â€” Hatchlings are 2Ã— more impressionable than adults
- **Core Memory Formation** â€” Significant events become permanent memories

### ðŸŽ® Life Simulation
- **6-Stage Growth** â€” Egg â†’ Hatchling â†’ Puppy â†’ Juvenile â†’ Adolescent â†’ Adult
- **6-Axis Needs System** â€” Hunger, Warmth, Attention, Rest, Play, Cleanliness
- **Real-Time Day/Night** â€” Synced to local time with aurora at night
- **Care Grade** â€” S to F rating based on positive vs. negative experiences
- **Streak Tracking** â€” Daily check-in streaks with celebrations

### ðŸŽ¨ Immersive 3D Experience
- **Dynamic Environment** â€” Grass, flowers, clouds, aurora that shift with time
- **Infinite World** â€” Treadmill-style world wrapping with parallax
- **Manga-Style UI** â€” Speech bubbles float in 3D space
- **Audio-Reactive** â€” Microphone input + procedural Web Audio sounds

### ðŸ“– Interactive Tutorial
- **8-Page Onboarding** â€” Kid-friendly introduction to all mechanics
- **Always Accessible** â€” Help button in top-right corner
- **PyraCard Guide** â€” Dedicated page explaining the share feature

---

## ðŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         App.tsx                                 â”‚
â”‚                    (Composition Root)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       UI.tsx           â”‚              Scene.tsx                 â”‚
â”‚   (2D HUD + PyraCard)  â”‚          (3D R3F Canvas)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     useGame Hook                                â”‚
â”‚         (Central Engine: State, Surprises, Celebrations)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  gemini     â”‚  behavior   â”‚  animation  â”‚   audio               â”‚
â”‚  Service    â”‚  Service    â”‚  Controller â”‚   Service             â”‚
â”‚ (AI + Nano  â”‚ (Psychology â”‚ (3D Motion) â”‚  (Sound FX +          â”‚
â”‚  Banana)    â”‚  & Memory)  â”‚             â”‚   Celebrations)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      gameReducer                                â”‚
â”‚              (Predictable State Mutations)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      constants.ts                               â”‚
â”‚  (Decay Rates, Surprises, Memory Templates, Personality Config) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Services

| Service | Responsibility |
|---------|----------------|
| **geminiService** | AI chat responses + Nano Banana portrait generation |
| **behaviorService** | Personality shifts, memory formation, preference detection |
| **animationController** | 3D model animation state machine + world scrolling |
| **audioService** | Web Audio synthesis, celebration sounds, ambient music |

---

## ðŸš€ Getting Started

### Prerequisites

- Node.js 18+
- Google Gemini API key ([Get one here](https://ai.google.dev/))

### Installation

```bash
# Clone the repository
git clone https://github.com/yourusername/pyra.git
cd pyra

# Install dependencies
npm install

# Configure environment
cp .env.example .env
# Add your API_KEY to .env

# Start development server
npm run dev
```

### Environment Variables

| Variable | Description | Required |
|----------|-------------|----------|
| `API_KEY` | Google Gemini API key | Yes |

> **Note:** The same API key powers both chat (Gemini 2.5 Flash) and portrait generation (Nano Banana / Gemini 2.5 Flash Image).

---

## ðŸ“ Project Structure

```
â”œâ”€â”€ App.tsx                    # Root composition
â”œâ”€â”€ index.tsx                  # Entry point
â”œâ”€â”€ constants.ts               # Game config, surprises, memory templates
â”œâ”€â”€ types.ts                   # TypeScript definitions
â”œâ”€â”€ utils.ts                   # Prompt building & helpers
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Scene.tsx              # Three.js 3D scene
â”‚   â”œâ”€â”€ UI.tsx                 # HUD, PyraCard, modals
â”‚   â”œâ”€â”€ CelebrationModal.tsx   # Evolution/milestone celebrations
â”‚   â”œâ”€â”€ TutorialModal.tsx      # Interactive onboarding
â”‚   â”œâ”€â”€ LoadingScreen.tsx      # Initial loading state
â”‚   â””â”€â”€ environment/           # 3D environment components
â”‚       â”œâ”€â”€ AuroraSky.tsx
â”‚       â”œâ”€â”€ Clouds.tsx
â”‚       â”œâ”€â”€ Flowers.tsx
â”‚       â””â”€â”€ GrassField.tsx
â”‚
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useGame.ts             # Central game engine & state
â”‚
â””â”€â”€ services/
    â”œâ”€â”€ geminiService.ts       # AI chat + portrait generation
    â”œâ”€â”€ behaviorService.ts     # Psychology, memory, personality
    â”œâ”€â”€ animationController.ts # 3D animation & world wrapping
    â””â”€â”€ audioService.ts        # Sound effects & music
```

---

## ðŸŽ¯ Game Mechanics Deep Dive

### The Personality System

```typescript
// 6 Dimensions that shift based on your care
personality: {
  fearfulness: number;      // -100 confident â†” +100 fearful
  attachment: number;       // -100 independent â†” +100 clingy
  obedience: number;        // -100 rebellious â†” +100 eager-to-please
  energy: number;           // -100 calm â†” +100 hyperactive
  trustDisposition: number; // -100 suspicious â†” +100 trusting
  temperament: number;      // -100 impatient â†” +100 patient
}
```

### Stage Plasticity (How Much Experiences Matter)

| Stage | Multiplier | Meaning |
|-------|------------|---------|
| Hatchling | 2.0Ã— | Extremely impressionable |
| Puppy | 1.5Ã— | Highly formative |
| Juvenile | 1.0Ã— | Moderate influence |
| Adolescent | 0.5Ã— | Resistant to change |
| Adult | 0.3Ã— | Personality largely fixed |

### Memory Formation

**Trauma Memories:**
| Trigger | Memory | Impact |
|---------|--------|--------|
| Hunger = 0 | "Remembers being terribly hungry" | +8 fear, -5 trust |
| Warmth = 0 | "Remembers being freezing cold" | +10 fear, -5 trust |
| 48h alone | "Remembers being abandoned" | -10 attachment, -15 trust |

**Joy Memories:**
| Trigger | Memory | Impact |
|---------|--------|--------|
| Saved from critical | "Remembers being rescued" | +10 trust, +8 attachment |
| Petted while scared | "Remembers being comforted" | -10 fear, +8 trust |
| Trust reaches 75 | "Feels truly loved" | +15 trust disposition |

### Daily Surprise Types

| Type | Example | Personality Bias |
|------|---------|------------------|
| Found Item | "Found a shiny pebble!" | None |
| Learned Trick | "Practiced their roar!" | High energy |
| Funny Moment | "Chased their own tail!" | Very high energy |
| Waiting Gift | "Saved the best spot for you!" | High attachment |
| Dream | "Dreamed about playing together!" | High trust |
| Discovery | "Made friends with a bug!" | Low fearfulness |

---

## ðŸ–¼ï¸ Portrait Generation

Pyra uses **Nano Banana (Gemini 2.5 Flash Image)** to generate unique portraits:

```typescript
// Prompt incorporates all visual traits
const prompt = `Transform this T-Rex character portrait:
  - Body color: ${bodyColor} (${hexCode})
  - Eye glow: ${eyeColor}
  - Pattern: ${scalePattern}
  - Expression: ${personalityExpression}
  - Background: ${stageBackground}
  - Style: Children's book illustration`;
```

### Portrait Features
- **Reference Image** â€” Uses T-Rex template for consistent character design
- **HSL Color Mapping** â€” Exact color from seed.appearance applied
- **Personality Expression** â€” Shy, confident, playful based on traits
- **Stage Backgrounds** â€” Nest â†’ Meadow â†’ Forest â†’ Mountains â†’ Epic fantasy
- **7-Day Cache** â€” Stored in localStorage, regenerates on evolution

---

## ðŸ› ï¸ Tech Stack

| Layer | Technology |
|-------|------------|
| **Frontend** | React 18, TypeScript |
| **3D Rendering** | Three.js, React Three Fiber, Drei |
| **AI Chat** | Google Gemini 2.5 Flash |
| **AI Portraits** | Nano Banana (Gemini 2.5 Flash Image) |
| **Audio** | Web Audio API |
| **State** | useReducer + localStorage |
| **Styling** | Tailwind CSS |

---

## ðŸŽ“ The Core Philosophy

### Why Early Care Matters Most

The plasticity system ensures that a hatchling's experiences shape them **twice as much** as the same experiences would affect an adult. This mirrors real developmental psychologyâ€”early attachment patterns form the foundation for all future relationships.

### The Weight of Memory

Memories in Pyra are **permanent**. You cannot undo a moment of starvation or erase the trauma of abandonment. This creates real stakesâ€”your choices have consequences that persist throughout Pyra's entire life.

### Partnership, Not Ownership

The adult stage explicitly states:
> *"You are loyal, but you are not subservient. You are partners."*

The goal isn't to create an obedient pet. It's to build a genuine relationship with a creature that has its own personality, preferences, and history.

### The Story You Write

Every Pyra is unique because:
1. **Random seed traits** â€” Innate personality foundation
2. **Your care patterns** â€” How you respond to needs
3. **Memorable moments** â€” Crises averted or allowed
4. **Time invested** â€” Streaks, consistency, presence

The PyraCard feature lets you capture and share this unique storyâ€”a snapshot of the companion you've raised.

---

## ðŸ“„ License

This work is licensed under a [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/).

You are free to:
- **Share** â€” copy and redistribute in any medium or format
- **Adapt** â€” remix, transform, and build upon for any purpose

Under the following terms:
- **Attribution** â€” Give appropriate credit and indicate if changes were made

---

<div align="center">

**The story you write together is yours alone.** ðŸ¦–ðŸ’š

*Now go say hello to your new friend.*

</div>

---